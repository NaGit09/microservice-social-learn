import clsx from "clsx";
import {
  Carousel,
  CarouselContent,
  CarouselItem,
  CarouselNext,
  CarouselPrevious,
} from "components/carousel";
import DropdownShowMoreOptions from "features/dropdown/dropdown-show-more-options";
import FooterActionsPost from "layout/footer-actions-post";
import HeaderPostUser from "layout/header-post-user";
import { getFullName, getUserIdFromCookie } from "utils/user.utils";

const CardPostUser = (props) => {
  const { postData } = props;

  const userName = getFullName(
    postData.userId?.first_name,
    postData.userId?.last_name
  );
  const ID = getUserIdFromCookie();

  const navigateHome =
    postData.userId?._id !== ID
      ? /welcome/home-guest/${postData.userId?._id}
      : /welcome/home-user/${ID};

  return (
    <div className="max-w-[40vw] w-[40vw] p-2" {...props}>
      <div
        className={clsx(
          "flex flex-col items-center gap-2 py-2 w-full overflow-hidden",
          "border border-black dark:border-white rounded-lg"
        )}
      >
        <HeaderPostUser
          className="h-16 rounded-lg w-full"
          img={postData.avatar}
          name={userName}
          privacy={postData.privacy}
          href={navigateHome}
          createAt={postData.createAt}
          action={
            <DropdownShowMoreOptions
              user_id={postData.userId?._id}
              post_id={postData.id}
              privacy={postData.privacy}
            />
          }
        />

        <div className="w-full flex flex-col">
          <Carousel className="w-full max-h-[450px]">
            <CarouselContent>
              {postData.img.map((img, index) => (
                <CarouselItem key={index}>
                  <img
                    lazy="loading"
                    src={img.url}
                    alt="post"
                    className="w-full h-[450px] object-fill"
                  />
                </CarouselItem>
              ))}
            </CarouselContent>
            <CarouselPrevious className="left-2" />
            <CarouselNext className="right-2" />
          </Carousel>

          <FooterActionsPost
            post_id={postData.id}
            postDescription={postData.description}
            userName={userName}
            privacy={postData.privacy}
            liked_post={postData.liked}
            number_likes={postData.numberLikes}
            saved_posts={postData.savedPosts}
          />
        </div>
      </div>
    </div>
  );
};

export default CardPostUser;